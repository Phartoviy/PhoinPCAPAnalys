# PCAP Report (Universal, RU) — офлайн анализатор PCAP на C++/libpcap

Утилита для офлайн-анализа `pcap/pcapng` файлов и генерации подробного отчёта **на русском языке**. Поддерживает распространённые форматы канального уровня (DLT) и умеет работать с дампами, снятыми в Linux (включая `SLL2`), на loopback, raw IP и т.д.

Выходные форматы отчёта:
- `*.txt` — человекочитаемый отчёт
- `*.json` — структурированные данные для дальнейшей обработки

По умолчанию анализируется **только IPv4**. При необходимости можно включить подсчёт IPv6 ключом `--ipv6`.

---

## Возможности

- Авто-детект и поддержка популярных DLT/linktype:
  - Ethernet (`DLT_EN10MB`)
  - Linux cooked (`DLT_LINUX_SLL`, `DLT_LINUX_SLL2`)
  - Loopback/NULL (`DLT_LOOP`, `DLT_NULL`)
  - RAW IP (`DLT_RAW`)
  - Wi-Fi (best-effort): Radiotap/802.11 + LLC/SNAP (`DLT_IEEE802_11_RADIO`, `DLT_IEEE802_11`)
  - PPP (best-effort): (`DLT_PPP`, `DLT_PPP_SERIAL`)
- Подробная статистика:
  - L2/L3/L4: IPv4/IPv6, TCP/UDP/ICMP
  - TCP-флаги (SYN/ACK/FIN/RST/…)
  - распределение размеров пакетов (гистограмма по `caplen`)
  - топ IP-адресов и направлений `src -> dst`
  - топ портов (TCP/UDP)
  - топ потоков (агрегация без учёта направления)
- Эвристики “что происходило” (нарратив):
  - признаки порт-сканирования/разведки (по уникальным портам/хостам)
  - признаки SYN-штормов/массовых попыток соединений
  - DNS-активность (порт 53)
  - простейшее обнаружение HTTP-похожих пакетов на порту 80

---

## Требования

- Компилятор с поддержкой C++17 (gcc/clang)
- `libpcap`

---

## Установка зависимостей

### Debian/Ubuntu
```bash
sudo apt-get update
sudo apt-get install -y g++ libpcap-dev
